<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://www.w3.org/MarkUp/SCHEMA/xhtml11.xsd"
     xml:lang="en">
  <head>
    <title>Information Center for ARM</title>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <link type="text/css" rel="stylesheet" media="all" href="file://$TOOLKIT_DIR$/doc/infocenter/style/ewic.css" />
  </head>
  <body>
  <div id="topbanner"></div>
  <div id="titlebanner_small">
    <h2>Information Center for ARM</h2>
  </div>
  <div class="breadcrumb"><a href="$TOOLKIT_DIR$/doc/infocenter/index.ENU.html">Information Center for ARM</a> | EXAMPLES</div>
  <div class="mainblock">
   <h2>Example description</h2>

   <pre>  <!--Insert readme.txt-->
<span style="font-family: monospace;">
	RTC Backup domain

	Example Description

  This example demonstrates and explains how to use the peripherals available on
  Backup Domain. These peripherals are: the RCC_BDCR register containing the LSE
  Osc configuration and the RTC Clock enable/disable bits. It embeds also the RTC
  peripheral with its associated Backup Data registers. And finally the Backup SRAM
  (4KB) with its low power regulator allowing to preserve its contents when the
  product is powered by VBAT pin.

  As an application example, it demonstrates how to setup the RTC hardware calendar,
  RTC Backup Data registers read/write and BKPSRAM read/write operations.

  One from the following clock can be used as RTC clock source (uncomment the
  corresponding define in main.c):
    - LSE oscillator clock usually delivered by a 32.768 kHz quartz.
    - LSI oscillator clock

  The Backup (BKP) domain, still powered by VBAT when VDD is switched off, so its
  content is not lost if a battery is connected to the VBAT pin.
  A key value is written in backup data register 0 to indicate if the Backup Domain
  is already configured.

  The program behaves as follows:

  1. After startup the program checks the backup data register 0 value:
     - BKP_DR0 value not correct: (RTC_BKP_DR0 value is not correct or has not yet
       been programmed when the program is executed for the first time) the RTC is
       configured and the user is asked to set the time and date (entered on
       TFT-LCD) and the RTC Backup Data registers and BKPSRAM are written.

     - BKP_DR0 value correct: this means that the RTC is configured and the time
       and date are displayed on LCD. The content of RTC Backup Data registers
       and BKPSRAM is checked and the result is displayed on color LCD.

  2. When an External Reset occurs the BKP domain is not reset.

  3. When power on reset occurs:
     - If a battery is connected to the VBAT pin: the BKP domain is not reset and
       the RTC configuration is not lost.

     - If no battery is connected to the VBAT pin: the BKP domain is reset and the
       RTC configuration is lost.

  4. When an RTC Wakeup event occurs the RTC Wakeup interrupt is generated and the
     current Time/Date is refreshed on LCD.

  The example uses TFT-LCD and push-button to configure the RTC clock and display
  the current calendar:

  - When the Backup domain is not yet configured:
    - The RCC BDCR Register value is displayed on LCD before and after the Backup
      domain configuration.
    - All RTC Backup Data Registers are written and checked.
    - All BKP SRAM content is written and checked.
    - User asked for RTC Calendar Configuration using the Tamper/Wakeup/Key buttons:
       - Use TAMPER button to increment the current value.
       - Use WAKEUP button to validate the current value.
    - Once configured, the RTC Calendar is displayed on the LCD each second using
      the RTC Wakeup Interrupt.

  - When the Backup domain is already configured:
    - No need to reconfigure the RTC Clock and Calendar.
    - All RTC Backup Data Registers are checked.
    - All BKP SRAM content is checked. If the Low power regulator is enabled, the
      BKPSRAM content is not lost.
    - The RTC Calendar is displayed on the LCD each second using
      the RTC Wakeup Interrupt.


	Directory contents

  - RTC/RTC_BKPDomain/system_stm32f4xx.c    STM32F4xx system clock configuration file
  - RTC/RTC_BKPDomain/stm32f4xx_conf.h      Library Configuration file
  - RTC/RTC_BKPDomain/stm32f4xx_it.c        Interrupt handlers
  - RTC/RTC_BKPDomain/stm32f4xx_it.h        Header for stm32f4xx_it.c
  - RTC/RTC_BKPDomain/main.h                Main header file
  - RTC/RTC_BKPDomain/main.c                Main program
  - RTC/RTC_BKPDomain/lcd_log_conf.h        lcd_log configuration file

 note The "system_stm32f4xx.c" is generated by an automatic clock configuration
      tool and can be easily customized to your own configuration.
      To select different clock setup, use the "STM32F4xx_Clock_Configuration_V1.1.0.xls"
      provided with the AN3988 package available on <a href="http://www.st.com">ST Website</a>


	Hardware and Software environment

  - This example runs on STM32F40xx/STM32F41xx, STM32F427x/STM32F437x Devices.

  - This example has been tested with STMicroelectronics STM324xG-EVAL (STM32F40xx/
    STM32F41xx Devices) and STM32437I-EVAL (STM32F427x/STM32F437x Devices) evaluation
    boards and can be easily tailored to any other supported device and development
    board.

  - STM324xG-EVAL/STM32437I-EVAL Set-up
    - Use the TAMPER push button connected to PC.13 pin (EXTI Line13).
    - Use the WAKEUP push button connected to PA.00 pin (EXTI Line0).
    - All messages are displayed on the TFT-LCD.
    - Make sure that jumper JP19 is in position 2-3 to connect the 3V battery to VBAT pin

	How to use it ?

In order to make the program work, you must do the following :
 - Copy all source files from this example folder to the template folder under
   Project\STM32F4xx_StdPeriph_Templates
 - Open your preferred toolchain
 - Add the file "lcd_log.c" (under Utilities\STM32_EVAL\Common) to the project source list
 - Rebuild all files and load your image into target memory
 - Run the example


===============================================================================


	RTC Hardware Calendar

	Example Description

  This example demonstrates and explains how to use the RTC peripheral.
  As an application example, it demonstrates how to setup the RTC peripheral, in
  terms of prescaler and interrupts, to be used to keep time and to generate
  alarm interrupt.

  One from the following clock can be used as RTC clock source (uncomment the
  corresponding define in main.c):
    - LSE oscillator clock usually delivered by a 32.768 kHz quartz.
    - LSI oscillator clock

  The RTC is in the backup (BKP) domain, still powered by VBAT when VDD is switched off,
  so the RTC configuration is not lost if a battery is connected to the VBAT pin.
  A key value is written in backup data register 0 to indicate if the RTC is already
  configured.

  The program behaves as follows:

  1. After startup the program checks the backup data register 0 value:
     - BKP_DR0 value not correct: (RTC_BKP_DR0 value is not correct or has not yet
       been programmed when the program is executed for the first time) the RTC is
       configured.

     - BKP_DR0 value correct: this means that the RTC is configured and the time
       and Alarm A are displayed on Debugger.

  2. When an External Reset occurs the BKP domain is not reset and the RTC configuration
     is not lost. LED4 is On.

  3. When power on reset occurs:
     - If a battery is connected to the VBAT pin: the BKP domain is not reset and
       the RTC configuration is not lost. LED3 is On.

     - If no battery is connected to the VBAT pin: the BKP domain is reset and the
       RTC configuration is lost.

  4. When an RTC Alarm A event occurs the RTC Alarm interrupt is generated and the
     LED1 is toggled.

   - When Tamper button is pressed, the current time is displayed.
   - When WakeUp button is pressed, the current alarm A is displayed.

  LED2 is turned ON when the RTC configuration is done correctly.

	Directory contents

  - RTC/RTC_Calendar/system_stm32f4xx.c   STM32F4xx system clock configuration file
  - RTC/RTC_Calendar/stm32f4xx_conf.h     Library Configuration file
  - RTC/RTC_Calendar/stm32f4xx_it.c       Interrupt handlers
  - RTC/RTC_Calendar/stm32f4xx_it.h       Header for stm32f4xx_it.c
  - RTC/RTC_Calendar/main.c               Main program
  - RTC/RTC_Calendar/main.h               Main header file

 note The "system_stm32f4xx.c" is generated by an automatic clock configuration
      tool and can be easily customized to your own configuration.
      To select different clock setup, use the "STM32F4xx_Clock_Configuration_V1.1.0.xls"
      provided with the AN3988 package available on <a href="http://www.st.com">ST Website</a>


	Hardware and Software environment

  - This example runs on STM32F40xx/STM32F41xx, STM32F427x/STM32F437x Devices.

  - This example has been tested with STMicroelectronics STM324xG-EVAL (STM32F40xx/
    STM32F41xx Devices) and STM32437I-EVAL (STM32F427x/STM32F437x Devices) evaluation
    boards and can be easily tailored to any other supported device and development
    board.

  - STM324xG-EVAL/STM32437I-EVAL Set-up
    - Use the TAMPER push button connected to PC.13 pin (EXTI Line13).
    - Use the WAKEUP push button connected to PA.00 pin (EXTI Line0).
    - Make sure that jumper JP19 is in position 2-3 to connect the 3V battery to VBAT pin

	How to use it ?

In order to make the program work, you must do the following :
 - Copy all source files from this example folder to the template folder under
   Project\STM32F4xx_StdPeriph_Templates
 - Open your preferred toolchain
 - Rebuild all files and load your image into target memory
 - Run the example


===============================================================================


	LSI RTC Hardware Calendar

	Example Description

  This example demonstrates and explains how to use the LSI clock source auto
  calibration to get a precise RTC clock.
  As an application example, it demonstrates how to configure the TIM5 timer
  internally connected to LSI clock output, in order to adjust the RTC prescaler.

  The Low Speed Internal (LSI) clock is used as RTC clock source.
  After reset, the RTC prescaler (asynchronous and synchronous) is set with the
  default LSI frequency (32KHz).
  The RTC WakeUp is configured to generate an interrupt each 1s. The WakeUp counter
  is clocked by the RTC CK_SPRE signal (1Hz) and its counter is set to 0.
  LED1 is toggled inside the RTC WakeUp interrupt each 1s.

  The inaccuracy of the LSI clock causes the RTC WakeUp Interrupt to be inaccurate.
  The RTC CK_SPRE signal can be monitored by LED1 which is toggled into the RTC
  Wakeup interrupt service routine.

  The program waits until TAMPER Push button is pressed to begin the auto calibration
  procedure:
   - Configure the TIM5 to remap internally the TIM5 Channel 4 Input Capture to
     the LSI clock output.
   - Enable the TIM5 Input Capture interrupt: after one cycle of LSI clock, the
     period value is stored in a variable and compared to the HCLK clock to get
     its real value.
   - The RTC prescaler is adjusted with this LSI frequency value so that the RTC
     CK_SPRE value become more accurate.
   - When calibration is done LED2 is turned ON to indicate the end of this operation.

	Directory contents

  - RTC/RTC_LSI/system_stm32f4xx.c    STM32F4xx system clock configuration file
  - RTC/RTC_LSI/stm32f4xx_conf.h      Library Configuration file
  - RTC/RTC_LSI/stm32f4xx_it.c        Interrupt handlers
  - RTC/RTC_LSI/stm32f4xx_it.h        Header for stm32f4xx_it.c
  - RTC/RTC_LSI/main.h                Header for main.c module
  - RTC/RTC_LSI/main.c                Main program

 note The "system_stm32f4xx.c" is generated by an automatic clock configuration
      tool and can be easily customized to your own configuration.
      To select different clock setup, use the "STM32F4xx_Clock_Configuration_V1.1.0.xls"
      provided with the AN3988 package available on <a href="http://www.st.com">ST Website</a>

	Hardware and Software environment

  - This example runs on STM32F40xx/STM32F41xx, STM32F427x/STM32F437x Devices.

  - This example has been tested with STMicroelectronics STM324xG-EVAL (STM32F40xx/
    STM32F41xx Devices) and STM32437I-EVAL (STM32F427x/STM32F437x Devices) evaluation
    boards and can be easily tailored to any other supported device and development
    board.

  - STM324xG-EVAL/STM32437I-EVAL Set-up
    - Use the TAMPER push button connected to PC.13 pin (EXTI Line13).

	How to use it ?

In order to make the program work, you must do the following :
 - Copy all source files from this example folder to the template folder under
   Project\STM32F4xx_StdPeriph_Templates
 - Open your preferred toolchain
 - Rebuild all files and load your image into target memory
 - Run the example


===============================================================================


	RTC StopWatch

	Example Description

  This example illustrates how to use the STM32F4xx new RTC's sub-seconds and
  Tamper feature (Filter, sampling) features. It simulates a precise chronometer
  with 10 record times possibilities stored in the Backup registers (10 registers
  for time (second, minutes and hours) and 10 registers for subsecond).

  For this example an interactive human interface is developed using STM324xx EVAL’s
  LCD and Push Buttons to allow user to use StopWatch with real time display.

  After startup, a default chronometer counter format "00:00:00:000" is displayed
  on the LCD, it corresponds to [Hours]:[minutes]:[seconds]:[milliseconds].
  User can manipulate the chronometer features using the Tamper and Wakeup buttons:
    - press Wakeup button to start counter.
    - press Tamper button to save trials in the backup registers (max 10 actions).

	Directory contents

  - RTC/RTC_StopWatch/system_stm32f4xx.c    STM32F4xx system clock configuration file
  - RTC/RTC_StopWatch/stm32f4xx_conf.h      Library Configuration file
  - RTC/RTC_StopWatch/stm32f4xx_it.c        Interrupt handlers
  - RTC/RTC_StopWatch/stm32f4xx_it.h        Header for stm32f4xx_it.c
  - RTC/RTC_StopWatch/main.c                Main program
  - RTC/RTC_StopWatch/main.h                Main header file

 note The "system_stm32f4xx.c" is generated by an automatic clock configuration
      tool and can be easily customized to your own configuration.
      To select different clock setup, use the "STM32F4xx_Clock_Configuration_V1.1.0.xls"
      provided with the AN3988 package available on <a href="http://www.st.com">ST Website</a>


	Hardware and Software environment

  - This example runs on STM32F40xx/STM32F41xx, STM32F427x/STM32F437x Devices.

  - This example has been tested with STMicroelectronics STM324xG-EVAL (STM32F40xx/
    STM32F41xx Devices) and STM32437I-EVAL (STM32F427x/STM32F437x Devices) evaluation
    boards and can be easily tailored to any other supported device and development
    board.

  - STM324xG-EVAL/STM32437I-EVAL Set-up
    - Use Wakeup pash button.
    - Use the TAMPER push button connected to PC.13 pin (EXTI Line13).

	How to use it ?

In order to make the program work, you must do the following :
 - Copy all source files from this example folder to the template folder under
   Project\STM32F4xx_StdPeriph_Templates
 - Open your preferred toolchain
 - Rebuild all files and load your image into target memory
 - Run the example


===============================================================================


	RTC Tamper

	Example Description

  This example shows how to write/read data to/from RTC Backup data registers and
  demonstrates the Tamper detection feature.

  One from the following clock can be used as RTC clock source (uncomment the
  corresponding define in main.c):
   - LSE oscillator clock usually delivered by a 32.768 kHz quartz.
   - LSI oscillator clock

  The associated firmware performs the following:

  1. It configures the RTC_AF1 pin Tamper to be falling edge, and enables the Tamper
     interrupt.

  2. It writes the data to all RTC Backup data registers, then check whether the
     data were correctly written. If yes, LED1 turns on, otherwise LED3 turns on.

  3. When applying a low level on the RTC_AF1 pin (PC.13), the RTC backup data registers
     are reset and the Tamper interrupt is generated. The corresponding ISR then checks
     whether the RTC Backup data registers are cleared or not. If yes LED2 turns ON,
     otherwise LED4 turns ON.


	Directory contents

  - RTC/RTC_Tamper/system_stm32f4xx.c    STM32F4xx system clock configuration file
  - RTC/RTC_Tamper/stm32f4xx_conf.h      Library Configuration file
  - RTC/RTC_Tamper/stm32f4xx_it.c        Interrupt handlers
  - RTC/RTC_Tamper/stm32f4xx_it.h        Header for stm32f4xx_it.c
  - RTC/RTC_Tamper/main.c                Main program
  - RTC/RTC_Tamper/main.h                Main header file

 note The "system_stm32f4xx.c" is generated by an automatic clock configuration
      tool and can be easily customized to your own configuration.
      To select different clock setup, use the "STM32F4xx_Clock_Configuration_V1.1.0.xls"
      provided with the AN3988 package available on <a href="http://www.st.com">ST Website</a>


	Hardware and Software environment

  - This example runs on STM32F40xx/STM32F41xx, STM32F427x/STM32F437x Devices.

  - This example has been tested with STMicroelectronics STM324xG-EVAL (STM32F40xx/
    STM32F41xx Devices) and STM32437I-EVAL (STM32F427x/STM32F437x Devices) evaluation
    boards and can be easily tailored to any other supported device and development
    board.

  - STM324xG-EVAL/STM32437I-EVAL Set-up
    - Use the TAMPER push button connected to PC.13 pin (EXTI Line13).

	How to use it ?

In order to make the program work, you must do the following :
 - Copy all source files from this example folder to the template folder under
   Project\STM32F4xx_StdPeriph_Templates
 - Open your preferred toolchain
 - Rebuild all files and load your image into target memory
 - Run the example


===============================================================================


	RTC Timer

	Example Description

  This example provides a short description of how to use the RTC peripheral with
  Alarm sub seconds feature to simulate a timer with refresh time equal to 250 ms
  (1 second/ 8) * 2).
  The RTC is configured to generate sub seconds interrupt each 125ms (will have
  8 interrupt per 1 second).

  For this example an interactive human interface is developed using STM324xx EVAL’s
  LCD and Push Buttons to allow user to use Timer with a real progress bar display.

  After startup, the timer is equal to 1 Minute (60 Seconds) and by pressing on
  the KEY button the progress bar start to be filled for each 2 successive
  interrupts (after each 250ms).
  After 480 interrupts (60 * 8) the progress bar will be full.

  User can manipulate the chronometer features using the Tamper and Wakeup buttons:
    - press Key button to Start the timer.
    - press Wakeup button to Reset the timer.
    - press Tamper button to stop the timer.


	Directory contents

  - RTC/RTC_Timer/system_stm32f4xx.c    STM32F4xx system clock configuration file
  - RTC/RTC_Timer/stm32f4xx_conf.h      Library Configuration file
  - RTC/RTC_Timer/stm32f4xx_it.c        Interrupt handlers
  - RTC/RTC_Timer/stm32f4xx_it.h        Header for stm32f4xx_it.c
  - RTC/RTC_Timer/main.c                Main program
  - RTC/RTC_Timer/main.h                Main header file

 note The "system_stm32f4xx.c" is generated by an automatic clock configuration
      tool and can be easily customized to your own configuration.
      To select different clock setup, use the "STM32F4xx_Clock_Configuration_V1.1.0.xls"
      provided with the AN3988 package available on <a href="http://www.st.com">ST Website</a>


	Hardware and Software environment

  - This example runs on STM32F40xx/STM32F41xx, STM32F427x/STM32F437x Devices.

  - This example has been tested with STMicroelectronics STM324xG-EVAL (STM32F40xx/
    STM32F41xx Devices) and STM32437I-EVAL (STM32F427x/STM32F437x Devices) evaluation
    boards and can be easily tailored to any other supported device and development
    board.

  - STM324xG-EVAL/STM32437I-EVAL Set-up
    - Use Wakeup push button.
    - Use the TAMPER push button connected to PC.13 pin (EXTI Line13).


	How to use it ?

In order to make the program work, you must do the following :
 - Copy all source files from this example folder to the template folder under
   Project\STM32F4xx_StdPeriph_Templates
 - Open your preferred toolchain
 - Rebuild all files and load your image into target memory
 - Run the example


===============================================================================


	RTC TimeStamp

	Example Description

  This example provides a short description of how to use the RTC peripheral and
  the Time Stamp feature.

  One from the following clock can be used as RTC clock source (uncomment the
  corresponding define in main.c):
   - LSE oscillator clock usually delivered by a 32.768 kHz quartz.
   - LSI oscillator clock

  The program behaves as following:

  1. At startup the program checks the backup data register 0 value:
     - BKP_DR0 value not correct: (RTC_BKP_DR0 value is not correct or has not yet
       been programmed when the program is executed for the first time) the RTC is
       configured and the user is asked to set the time and date (to be entered via
       HyperTerminal).
     - BKP_DR0 value correct: this means that the RTC is configured and the time
       date and timestamp (time and date) are displayed.

  2. When an External Reset occurs the BKP domain is not reset and the RTC configuration
     is not lost.

  3. When power on reset occurs:
     - If a battery is connected to the VBAT pin :
       the BKP domain is not reset and the RTC configuration is not lost.
     - If no battery is connected to the VBAT pin :
       the BKP domain is reset and the RTC configuration is lost.

  4. It configures the RTC TimeStamp pin to be falling edge and enables the
     TimeStamp detection.

  5. Applying a low level on the TimeStamp pin (PC.13) by pressing TAMPER push button,
     the calendar is saved in the time-stamp registers thanks to the timestamp event
     detection.

  The example uses HyperTerminal to configure the RTC clock, display the current
  time and timestamp registers contents:
   - Pressing TAMPER push button, saves the current time and date in RTC TSTR
     and TSDR registers and  displays the current RTC Calendar (Time and date) and
     RTC TimeStamp Calendar (Time and date). LED2 turns ON and LED1 off..
   - Pressing WakeUp push button, clears the TimeStamp Calendar. LED1 turns ON and
     LED2 off.

	Directory contents

  - RTC/RTC_TimeStamp/system_stm32f4xx.c   STM32F4xx system clock configuration file
  - RTC/RTC_TimeStamp/stm32f4xx_conf.h     Library Configuration file
  - RTC/RTC_TimeStamp/stm32f4xx_it.c       Interrupt handlers
  - RTC/RTC_TimeStamp/stm32f4xx_it.h       Header for stm32f4xx_it.c
  - RTC/RTC_TimeStamp/main.c               Main program
  - RTC/RTC_TimeStamp/main.h               Main header file

 note The "system_stm32f4xx.c" is generated by an automatic clock configuration
      tool and can be easily customized to your own configuration.
      To select different clock setup, use the "STM32F4xx_Clock_Configuration_V1.1.0.xls"
      provided with the AN3988 package available on <a href="http://www.st.com">ST Website</a>


	Hardware and Software environment

  - This example runs on STM32F40xx/STM32F41xx, STM32F427x/STM32F437x Devices.

  - This example has been tested with STMicroelectronics STM324xG-EVAL (STM32F40xx/
    STM32F41xx Devices) and STM32437I-EVAL (STM32F427x/STM32F437x Devices) evaluation
    boards and can be easily tailored to any other supported device and development
    board.

  - STM324xG-EVAL/STM32437I-EVAL Set-up
    - Use Wakeup push button.
    - Use the TAMPER push button connected to PC.13 pin (EXTI Line13).


	How to use it ?

In order to make the program work, you must do the following :
 - Copy all source files from this example folder to the template folder under
   Project\STM32F4xx_StdPeriph_Templates
 - Open your preferred toolchain
 - Rebuild all files and load your image into target memory
 - Run the example

</span>
  </pre>
  </div>
  </body>
</html>

